# üèóÔ∏è Arquitectura Modular - Renata AI

## üìã √çndice
1. [Resumen Ejecutivo](#resumen-ejecutivo)
2. [Flujo de Mensajes](#flujo-de-mensajes)
3. [Archivos por Desarrollador](#archivos-por-desarrollador)
4. [Momento de Ejecuci√≥n](#momento-de-ejecuci√≥n)
5. [Puntos de Integraci√≥n](#puntos-de-integraci√≥n)
6. [Gu√≠a de Desarrollo](#gu√≠a-de-desarrollo)

---

## üéØ Resumen Ejecutivo

Esta arquitectura permite a **2 desarrolladores** trabajar simult√°neamente sin conflictos:

- **Desarrollador A (Tu compa√±ero):** Trabaja en l√≥gica de **clientes** (usuarios registrados)
- **Desarrollador B (T√∫):** Trabajas en l√≥gica de **prospectos** + WhatsApp + ElevenLabs

### Separaci√≥n de Responsabilidades

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    Servicio WhatsApp                        ‚îÇ
‚îÇ              (Desarrollador B - T√ö)                         ‚îÇ
‚îÇ  - Captura mensajes de WhatsApp                             ‚îÇ
‚îÇ  - Integraci√≥n con ElevenLabs (futuro)                      ‚îÇ
‚îÇ  - Routing inicial                                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                         ‚îÇ
                         ‚ñº POST /api/router/identify
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              Router Service (NEUTRAL)                       ‚îÇ
‚îÇ  - Decide: ¬øCliente o Prospecto?                           ‚îÇ
‚îÇ  - NO tiene l√≥gica de negocio                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                                                 ‚îÇ
        ‚ñº Cliente                                         ‚ñº Prospecto
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   agent.js          ‚îÇ                   ‚îÇ   prospecto.js          ‚îÇ
‚îÇ (Desarrollador A)   ‚îÇ                   ‚îÇ (Desarrollador B - T√ö) ‚îÇ
‚îÇ - Clientes          ‚îÇ                   ‚îÇ - Prospectos            ‚îÇ
‚îÇ - RAG con contratos ‚îÇ                   ‚îÇ - C√≥digo "SKY"          ‚îÇ
‚îÇ - OpenAI GPT-4o     ‚îÇ                   ‚îÇ - Registro              ‚îÇ
‚îÇ - Ventas/Compras    ‚îÇ                   ‚îÇ - Info servicios        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîÑ Flujo de Mensajes Completo

### **1. Usuario env√≠a mensaje por WhatsApp**

```javascript
// services/whatsapp/index.js (L√≠nea 54)
whatsappClient.on('message', async (msg) => {
  const phoneNumber = from.split('@')[0]; // "56993788826"
```

### **2. WhatsApp Service consulta al Router**

```javascript
// services/whatsapp/index.js (L√≠nea 70-77)
const routeResponse = await fetch(`${WORKER_API_URL}/api/router/identify`, {
  method: 'POST',
  body: JSON.stringify({ telefono: phoneNumber })
});

const { type } = await routeResponse.json(); // 'cliente' o 'prospecto'
```

### **3. Router identifica tipo de usuario**

```javascript
// services/worker/src/routes/router.js (L√≠nea 33-46)
router.post('/identify', async (c) => {
  const type = await routeMessage(c.env.DB, telefono);
  return c.json({ type }); // Retorna 'cliente' o 'prospecto'
});

// services/worker/src/services/userRouter.js (L√≠nea 60-72)
export async function routeMessage(db, phoneNumber) {
  const userInfo = await identifyUser(db, phoneNumber);

  if (isActiveClient(userInfo)) {
    return 'cliente';  // Usuario verificado en DB
  }

  return 'prospecto';  // Usuario no registrado
}
```

### **4. WhatsApp env√≠a a la ruta correcta**

```javascript
// services/whatsapp/index.js (L√≠nea 88-102)
const endpoint = type === 'cliente'
  ? '/api/agent/message'      // ‚Üê Desarrollador A
  : '/api/prospecto/message'; // ‚Üê Desarrollador B (T√ö)

const response = await fetch(`${WORKER_API_URL}${endpoint}`, {
  method: 'POST',
  body: JSON.stringify({ telefono, mensaje })
});
```

### **5A. Flujo de CLIENTES (agent.js)**

```javascript
// services/worker/src/routes/agent.js (L√≠nea 46)
router.post('/message', async (c) => {
  const user = await c.env.DB.prepare(
    'SELECT rut, nombre FROM contributors WHERE telefono = ?'
  ).bind(telefono).first();

  // Categorizar pregunta
  const questionType = categorizeQuestion(mensaje);

  // Procesar seg√∫n tipo
  if (questionType === 'ventas' || questionType === 'compras') {
    answer = await handleTaxQuestion(...);
  } else if (questionType === 'contrato') {
    answer = await handleContractQuestion(...); // RAG + OpenAI
  }

  return c.json({ respuesta: answer });
});
```

### **5B. Flujo de PROSPECTOS (prospecto.js - T√ö)**

```javascript
// services/worker/src/routes/prospecto.js (L√≠nea 44)
router.post('/message', async (c) => {
  const { telefono, mensaje } = await c.req.json();

  // Verificar sesi√≥n de registro
  const session = await c.env.SESSIONS_KV.get(`registro:${telefono}`);

  if (session) {
    // Continuar registro (pasos: RUT, nombre, password, clave SII)
    respuesta = await handleRegistroFlow(...);
  } else {
    // Primera interacci√≥n
    if (mensaje === 'SKY') {
      respuesta = await iniciarRegistro(...);
    } else if (mensaje === '1') {
      respuesta = getServicioContabilidad();
    } else if (mensaje === '2') {
      respuesta = getServicioRenataAI();
    } else {
      respuesta = getMensajeBienvenida();
    }
  }

  return c.json({ respuesta });
});
```

### **6. Respuesta vuelve a WhatsApp**

```javascript
// services/whatsapp/index.js (L√≠nea 110-115)
const data = await response.json();
const answer = data.respuesta;

await msg.reply(answer);
console.log(`[${type.toUpperCase()}] Respuesta enviada`);
```

---

## üìÅ Archivos por Desarrollador

### **üü¶ DESARROLLADOR A (Tu compa√±ero) - CLIENTES**

#### Archivo Principal:
- **`services/worker/src/routes/agent.js`** ‚úÖ SU ZONA EXCLUSIVA
  - Maneja clientes verificados
  - L√≥gica RAG con contratos
  - Consultas de ventas/compras
  - Integraci√≥n con OpenAI GPT-4o

#### Archivos Relacionados:
- `services/worker/src/utils/openai.js` - Funciones de OpenAI
- `services/worker/src/routes/contratos.js` - Gesti√≥n de contratos PDF
- `services/worker/src/routes/ventas.js` - Endpoints de ventas
- `services/worker/src/routes/compras.js` - Endpoints de compras

---

### **üü© DESARROLLADOR B (T√ö) - PROSPECTOS + WHATSAPP**

#### Archivos Principales:
- **`services/worker/src/routes/prospecto.js`** ‚úÖ TU ZONA EXCLUSIVA
  - Maneja prospectos (no registrados)
  - C√≥digo de activaci√≥n "SKY"
  - Proceso de registro guiado
  - Informaci√≥n de servicios

- **`services/whatsapp/index.js`** ‚úÖ TU ZONA PRINCIPAL
  - Gateway de WhatsApp
  - Captura mensajes
  - Routing a Worker API
  - Integraci√≥n futura con ElevenLabs

#### Archivos de Soporte:
- `services/worker/src/services/userRouter.js` - L√≥gica de identificaci√≥n
- `services/worker/src/routes/router.js` - Endpoint de routing

#### Futuro - ElevenLabs (T√ö):
- `services/whatsapp/services/elevenLabs.js` (crear)
- `services/worker/src/services/elevenLabs.js` (crear)

---

### **‚ö™ ARCHIVOS COMPARTIDOS (Ambos)

- **`services/worker/src/index.js`**
  - Solo para agregar rutas nuevas
  - Comunicarse antes de modificar
  - Cada uno agrega sus imports/routes

---

## ‚è∞ Momento de Ejecuci√≥n

### ¬øCu√°ndo se ejecuta `agent.js`?

```
1. Usuario registrado env√≠a mensaje por WhatsApp
   ‚Üì
2. services/whatsapp/index.js (L√≠nea 54) captura evento 'message'
   ‚Üì
3. services/whatsapp/index.js (L√≠nea 70) llama a /api/router/identify
   ‚Üì
4. services/worker/src/routes/router.js (L√≠nea 33) identifica: 'cliente'
   ‚Üì
5. services/whatsapp/index.js (L√≠nea 92) llama a /api/agent/message
   ‚Üì
6. services/worker/src/index.js (L√≠nea 47) recibe HTTP request
   ‚Üì
7. services/worker/src/index.js (L√≠nea 37) rutea a agentRoutes
   ‚Üì
8. services/worker/src/routes/agent.js (L√≠nea 46) SE EJECUTA AQU√ç ‚≠ê
   ‚Üì
9. Procesa mensaje y retorna respuesta
   ‚Üì
10. services/whatsapp/index.js (L√≠nea 114) env√≠a respuesta por WhatsApp
```

### ¬øCu√°ndo se ejecuta `prospecto.js`?

```
1. Usuario NO registrado env√≠a mensaje por WhatsApp
   ‚Üì
2. Mismo flujo hasta paso 4
   ‚Üì
4. services/worker/src/routes/router.js identifica: 'prospecto'
   ‚Üì
5. services/whatsapp/index.js llama a /api/prospecto/message
   ‚Üì
6-7. Igual que antes
   ‚Üì
8. services/worker/src/routes/prospecto.js (L√≠nea 44) SE EJECUTA AQU√ç ‚≠ê
```

---

## üîå Puntos de Integraci√≥n

### **1. Router Service (Neutral)**

**Archivo:** `services/worker/src/services/userRouter.js`

**Funci√≥n principal:**
```javascript
export async function identifyUser(db, phoneNumber) {
  const user = await db.prepare(
    'SELECT rut, nombre, verified FROM contributors WHERE telefono = ?'
  ).bind(phoneNumber).first();

  if (user) {
    return { type: 'cliente', data: { rut, nombre, verified } };
  }

  return { type: 'prospecto', data: { telefono } };
}
```

**Criterio de decisi√≥n:**
- Usuario existe en `contributors` + `verified=1` ‚Üí **Cliente** ‚Üí `agent.js`
- Cualquier otro caso ‚Üí **Prospecto** ‚Üí `prospecto.js`

---

### **2. Formato de Request/Response**

#### Request a `/api/agent/message` (Clientes):
```json
{
  "telefono": "+56993788826",  // Con prefijo +
  "mensaje": "¬øCu√°nto vend√≠ en octubre?"
}
```

#### Request a `/api/prospecto/message` (Prospectos):
```json
{
  "telefono": "56993788826",   // Sin prefijo +
  "mensaje": "Hola"
}
```

#### Response (Ambos):
```json
{
  "respuesta": "Texto de respuesta para el usuario"
}
```

---

### **3. Contrato de Datos**

#### Tabla `contributors`:
```sql
CREATE TABLE contributors (
    rut TEXT PRIMARY KEY,
    nombre TEXT NOT NULL,
    password_hash TEXT NOT NULL,
    clave_sii TEXT NOT NULL,
    telefono TEXT NOT NULL,     -- Formato: "56993788826" (sin +)
    verified INTEGER DEFAULT 0,  -- 0 o 1
    created_at TEXT DEFAULT CURRENT_TIMESTAMP
);
```

#### KV Store para sesiones de registro:
```javascript
// Key: "registro:{telefono}"
// Value: JSON
{
  "step": "solicitar_rut" | "solicitar_nombre" | "solicitar_password" | "solicitar_clave_sii",
  "data": {
    "telefono": "56993788826",
    "rut": "76123456-7",      // Agregado en paso 1
    "nombre": "Mi Empresa",   // Agregado en paso 2
    "password": "abc123"      // Agregado en paso 3
    // clave_sii agregada en paso 4 ‚Üí completa registro
  }
}
// TTL: 900 segundos (15 minutos)
```

---

## üõ†Ô∏è Gu√≠a de Desarrollo

### **Para Desarrollador A (Clientes)**

#### Tu archivo principal:
```bash
services/worker/src/routes/agent.js
```

#### C√≥mo probar tu c√≥digo sin WhatsApp:
```bash
# Enviar request directamente al endpoint
curl -X POST http://localhost:8787/api/agent/message \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TU_API_KEY" \
  -d '{
    "telefono": "+56993788826",
    "mensaje": "¬øCu√°nto vend√≠ en octubre?"
  }'
```

#### Variables de entorno que usas:
- `OPENAI_API_KEY` - Para GPT-4o
- `AGENT_API_KEY` - Autenticaci√≥n del endpoint
- `DB` - Base de datos D1
- `AI` - Workers AI para embeddings
- `CONTRATOS_INDEX` - Vectorize para RAG

---

### **Para Desarrollador B (Prospectos - T√ö)**

#### Tus archivos principales:
```bash
services/worker/src/routes/prospecto.js    # L√≥gica de prospectos
services/whatsapp/index.js                  # Gateway WhatsApp
```

#### C√≥mo probar tu c√≥digo:

**Opci√≥n 1: Simular mensaje de WhatsApp**
```bash
# Probar endpoint de prospecto directamente
curl -X POST http://localhost:8787/api/prospecto/message \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TU_API_KEY" \
  -d '{
    "telefono": "56999999999",
    "mensaje": "Hola"
  }'
```

**Opci√≥n 2: Probar router**
```bash
# Verificar que identifica correctamente
curl -X POST http://localhost:8787/api/router/identify \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer TU_API_KEY" \
  -d '{"telefono": "56999999999"}'

# Respuesta esperada:
# {"type": "prospecto"}
```

#### Variables de entorno que usas:
- `AGENT_API_KEY` - Autenticaci√≥n
- `DB` - Base de datos D1
- `SESSIONS_KV` - Almacenamiento de sesiones de registro
- `WHATSAPP_SERVICE_URL` - URL del servicio WhatsApp (Node.js)
- **Futuro:** `ELEVENLABS_API_KEY`

#### Modificar flujo de prospectos:
1. Edita `prospecto.js` - L√≥gica de negocio
2. NO toques `agent.js` - Es de tu compa√±ero
3. Si necesitas cambiar routing, modifica `userRouter.js`

---

### **Flujo de Trabajo Conjunto**

#### Cambios en `index.js` (Compartido):
1. Comunicarse antes de modificar
2. Cada uno agrega sus rutas:
   ```javascript
   // Desarrollador A
   import agentRoutes from './routes/agent.js';
   app.route('/api/agent', agentRoutes);

   // Desarrollador B
   import prospectoRoutes from './routes/prospecto.js';
   app.route('/api/prospecto', prospectoRoutes);
   ```

#### Git Workflow:
```bash
# Desarrollador A - Branch para clientes
git checkout -b feature/mejoras-clientes
# Modifica agent.js, contratos.js, etc.
git commit -m "Mejoras en l√≥gica RAG para clientes"

# Desarrollador B - Branch para prospectos
git checkout -b feature/prospectos-whatsapp
# Modifica prospecto.js, whatsapp/index.js
git commit -m "Agregar flujo de registro para prospectos"

# Merge independiente - Sin conflictos
```

---

## üéØ Casos de Uso por Archivo

### **agent.js (Desarrollador A)**

‚úÖ Usuario registrado pregunta: "¬øCu√°nto vend√≠ en octubre?"
‚úÖ Usuario registrado pregunta: "¬øCu√°l es la fecha de mi contrato?"
‚úÖ Usuario registrado pregunta sobre compras
‚úÖ Consultas que requieren acceso a datos del SII

### **prospecto.js (Desarrollador B - T√ö)**

‚úÖ Nuevo usuario env√≠a: "Hola"
‚úÖ Nuevo usuario env√≠a c√≥digo: "SKY"
‚úÖ Usuario en proceso de registro env√≠a su RUT
‚úÖ Usuario consulta: "1" (servicios de contabilidad)
‚úÖ Usuario consulta: "2" (Renata AI)

---

## üìä Diagrama de Archivos

```
services/
‚îú‚îÄ‚îÄ worker/src/
‚îÇ   ‚îú‚îÄ‚îÄ index.js                    ‚ö™ COMPARTIDO (coordinaci√≥n)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ agent.js                üü¶ DESARROLLADOR A (clientes)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prospecto.js            üü© DESARROLLADOR B (prospectos)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ router.js               ‚ö™ NEUTRAL (solo routing)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.js                 ‚ö™ COMPARTIDO (ambos usan)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ventas.js               üü¶ DESARROLLADOR A
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ compras.js              üü¶ DESARROLLADOR A
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ contratos.js            üü¶ DESARROLLADOR A
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ userRouter.js           üü© DESARROLLADOR B (creado por ti)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ sii.js                  üü¶ DESARROLLADOR A
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ queue.js                ‚ö™ COMPARTIDO
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ elevenLabs.js           üü© DESARROLLADOR B (futuro)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ openai.js               üü¶ DESARROLLADOR A
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crypto.js               ‚ö™ COMPARTIDO
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.js               ‚ö™ COMPARTIDO
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ middleware/
‚îÇ       ‚îî‚îÄ‚îÄ auth.js                 ‚ö™ COMPARTIDO
‚îÇ
‚îî‚îÄ‚îÄ whatsapp/
    ‚îú‚îÄ‚îÄ index.js                    üü© DESARROLLADOR B (TU ZONA)
    ‚îî‚îÄ‚îÄ services/
        ‚îî‚îÄ‚îÄ elevenLabs.js           üü© DESARROLLADOR B (futuro)
```

---

## ‚úÖ Checklist de Integraci√≥n

### Desarrollador A (Clientes):
- [ ] `agent.js` procesa mensajes de clientes verificados
- [ ] OpenAI GPT-4o funciona correctamente
- [ ] RAG con contratos retorna respuestas relevantes
- [ ] Consultas de ventas/compras funcionan

### Desarrollador B (Prospectos - T√ö):
- [ ] `prospecto.js` maneja mensajes de no registrados
- [ ] C√≥digo "SKY" inicia proceso de registro
- [ ] Registro guiado completa 4 pasos
- [ ] WhatsApp service rutea correctamente
- [ ] Router identifica cliente vs prospecto

### Ambos:
- [ ] No hay conflictos en `index.js`
- [ ] Variables de entorno configuradas
- [ ] Tests funcionan independientemente
- [ ] Documentaci√≥n actualizada

---

## üöÄ Pr√≥ximos Pasos

### Desarrollador B (T√ö):
1. Integrar ElevenLabs para mensajes de voz
2. Mejorar mensajes de bienvenida
3. Agregar m√°s validaciones en registro
4. Crear dashboard de prospectos

### Desarrollador A:
1. Mejorar RAG con m√°s contexto
2. Optimizar prompts de OpenAI
3. Agregar m√°s tipos de consultas tributarias
4. Mejorar categorizaci√≥n de preguntas

---

**Versi√≥n:** 1.0
**√öltima actualizaci√≥n:** 2025-10-25
**Autores:** Equipo Renata AI
